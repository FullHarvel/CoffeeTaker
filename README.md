ポートフォリオはこちらになります。<br>

# CoffeeTaker
  ## アプリの説明
  シンプルなコーヒー予約アプリです.<br>
  このアプリでは管理者（コーヒーを作る人）が１日の中でコーヒーを出せる時間帯を指定すると、ユーザー（コーヒーを作ってもらう人）がその時間帯の中からコーヒーを作ってほしい時間を指定できるシステムになっています。<br>
  ユーザーが時間を指定すると管理者の **Line** に通知が届きます。<br>
  デフォルトの時間を設定することで毎日、時間帯を設定する手間を省くことができます。<br>
  また「デフォルトの時間」「指定の時間」の両方を設定している場合には、指定の時間を優先してユーザーに表示されます。<br>
  管理者が指定した「デフォルトの時間」「指定の時間」を確認したい場合は管理者画面からそれぞれの履歴に飛び、確認することができます。
  
  ## デモページ
  - PC
 


https://user-images.githubusercontent.com/95427365/235277516-fedf9888-fec1-4323-be3c-559011bc7080.mp4



  - モバイル
  
  


https://user-images.githubusercontent.com/95427365/235280390-19408e3e-bb99-4520-ac11-14486e796658.mp4



- Line通知

![IMG_7680 2](https://user-images.githubusercontent.com/95427365/235278322-5fa384d4-32f7-4d94-821b-fd92413318a8.jpg)


  
  ## 注意点
  時間を指定する場合はモバイル端末で行うとエラーが起きる可能性があります。
  
  ## 作ることになった経緯
  兄はコーヒーを作るのが好きなので、いつも作ってくれるのですが「作業中」「就寝中」「お出かけ中」でコーヒーを作って欲しいと頼みづらいことがありました。<br>
  そこで、兄が大丈夫な時間帯を指定して, いつでも簡単にコーヒーを頼むことが出来ないかと思い、このアプリを作る事にしました。
  
  ## こだわった点
  - 今回はモダンでDockerやKubernetesとも親和性が高いと言われるGo言語を使ってみたいと思いアプリで使う事にしました。
  - また、コーヒーを頼んだ際に管理者に届く通知を 出来るだけお手軽に通知するべく、Lineで通知を送る事にしました。
  
  
  ## つまづいたところ
  - Go言語ではリクエストとレスポンスがURLでやり取りを行っていたので、テンプレート内でのaタグのhref属性をどのように設定すれば色んな端末で使えるように出来るのかがわからなかったこと。
  - Go言語ではサーバーを自身で実装するため、ハンドラとテンプレート、リクエストとレンスポンスを理解してプログラムを組んでいく必要があったこと。
  - データベースから取得した値を加工する作業をどうすればシンプルに出来るかが迷ったこと。
  - 管理者の時間指定を３０分刻みにする際に、色々なライブラリなどを使う方法もありましたが「表示されない」「上手く動作しない」などで時間がかかったこと。
  - ユーザ側の時間選択欄を作る際に、ユーザーが選びやすいよう　30分刻みで表示する必要があったので、データベースの時間帯の値を「数値に変えて処理する」「文字のまま加工する」など中々シンプルな方法が思いつかなかったこと。

  
  ## アプリの準備(Mac)
  - postgresqlのインストール
  - データベースの作成
      - データベース名はなんでも良い(後にプログラムに入れる値ではあります)<br>
      - データベース作成コマンド
      ``` CREATE DATABASE データベース名 ```
  - テーブルの作成(テーブル名をcoffeetimeとcoffeetime_defaultdeで行う)
    - テーブル作成コマンド<br>
    ```postgresql
    CREATE TABLE 各テーブル名 (
	  id SERIAL PRIMARY KEY,
	  created_at TIMESTAMP WITH TIME ZONE DEFAULT (NOW() AT TIME ZONE 'Asia/Tokyo'),
	  starttime varchar(30),
	  finishtime varchar(30));
    ```
  - lineのアクセストークンの取得→[アクセストークン取得方法はこちらのサイトを参考にしています。](https://www.itd-blog.jp/entry/line-token)
  - contentsディレクトリに.envファイルを作成
  - 環境変数のHOST(データベースのホスト名)、PORT(データベースのポート名)、USER(データベースのユーザ名)、PASSWORD(データベースのパスワード)、DBNAME(データベース名)、ACCESSTOKEN(後にLineで取得するアクセストークン)
  - githubからpostgresqlと環境変数を使うためのライブラリを取得する。
    (postgresql)
    
    ```
    go get github.com/joho/godotenv
    ```
    
    (環境変数)
    
    ```
    go get github.com/lib/pq
    ```
  
  ## アプリの準備(windows)
   - postgresqlのインストール
   - データベースの作成
       - データベース名はなんでも良い(後にプログラムに入れる値ではあります)<br>
       - データベース作成コマンド
       ``` CREATE DATABASE データベース名 ```
  - テーブルの作成(テーブル名をcoffeetimeとcoffeetime_defaultdeで行う)
    - テーブル作成コマンド<br>
    ```postgresql
    CREATE TABLE 各テーブル名 (
	  id SERIAL PRIMARY KEY,
	  created_at TIMESTAMP WITH TIME ZONE DEFAULT (NOW() AT TIME ZONE 'Asia/Tokyo'),
	  starttime varchar(30),
	  finishtime varchar(30));
    ```
  - lineのアクセストークンの取得→[アクセストークン取得方法はこちらのサイトを参考にしています。](https://www.itd-blog.jp/entry/line-token)
  - contentsディレクトリに.envファイルを作成
  - 環境変数のHOST(データベースのホスト名)、PORT(データベースのポート名)、USER(データベースのユーザ名)、PASSWORD(データベースのパスワード)、DBNAME(データベース名)、ACCESSTOKEN(後にLineで取得するアクセストークン)
  - modファイルの作成
    ```
    go mod init 
    ```
  - 不足しているモジュールの追加(go install でも試しましたが私の環境ではimportが使える状態にはなりませんでした。)
    ```
    go mod tidy
    ```
  
  ## アプリの使用方法
  - contentsディレクトリで
    ```
    go run main.go 
    ```
    を実行する
  - **アプリケーション“main”へのネットワーク受信接続を許可しますか?** と表示されるので**許可**を選択する
  - 実行パソコンで接続する
  	- URLに```http://localhost:8080/``` を入力し接続する。
  - 自宅の携帯で接続する(Wifiを通して繋げられるようになります。)
  	- 実行パソコンのローカルループバックアドレスを調べる
  	- URLに```http://localhost:8080/```の```localhost```の部分を調べたローカルループバックアドレスに変える
  	- 例　→ ```http://120.0.0.1:8080/```
  	
  
